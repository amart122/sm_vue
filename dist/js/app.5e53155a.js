(function(e){function t(t){for(var a,s,i=t[0],o=t[1],u=t[2],d=0,f=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&f.push(r[s][0]),r[s]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);l&&l(t);while(f.length)f.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,i=1;i<n.length;i++){var o=n[i];0!==r[o]&&(a=!1)}a&&(c.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={app:0},c=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],o=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=o;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0ac4":function(e,t,n){},"0efc":function(e,t,n){"use strict";n("94a9")},1683:function(e,t,n){},"288f":function(e,t,n){"use strict";n("79d8")},"30c5":function(e,t,n){"use strict";n("8e5d")},3192:function(e,t,n){},3968:function(e,t,n){"use strict";n("b511")},"3a14":function(e,t,n){"use strict";n("0ac4")},5044:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var a=n("1da1"),r=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("96cf"),n("d3b7"),n("99af"),n("b0c0"),n("260b")),c=n("ea7b"),s=n("7a23"),i={id:"main-container-sm",class:""};function o(e,t,n,a,r,c){var o=Object(s["B"])("Header"),u=Object(s["B"])("router-view"),l=Object(s["B"])("Loaders"),d=Object(s["B"])("Alerts");return Object(s["t"])(),Object(s["f"])("div",i,[this.$store.getters["getCurrentUser"]?(Object(s["t"])(),Object(s["d"])(o,{key:0})):Object(s["e"])("",!0),Object(s["j"])(u),Object(s["j"])(l),Object(s["j"])(d)])}var u={class:"loader-wrapper"},l=Object(s["h"])('<div id="circle-wave-loader" class="loader"><span class="circle circle-1"></span><span class="circle circle-2"></span><span class="circle circle-3"></span><span class="circle circle-4"></span><span class="circle circle-5"></span><span class="circle circle-6"></span><span class="circle circle-7"></span><span class="circle circle-8"></span></div><div id="bars-loader" class="loader"><div></div><div></div><div></div><div></div><div></div><div></div></div>',2),d=[l];function f(e,t){return Object(s["t"])(),Object(s["f"])("div",u,d)}const b={};b.render=f;var p=b,m={id:"sm-alert-container",class:""},g=Object(s["g"])("div",{class:"icon"},null,-1),j=Object(s["g"])("div",{class:"message"},[Object(s["g"])("span")],-1),h=Object(s["g"])("div",{class:"close"},null,-1),O=[g,j,h];function v(e,t){return Object(s["t"])(),Object(s["f"])("div",m,O)}const _={};_.render=v;var w=_;Object(s["w"])("data-v-29222ba7");var y={id:"navbar_main",class:"row-flex"},$={class:"logo-container nav-left col-2"},k=Object(s["g"])("img",{src:"/static/site/images/logo.png",alt:"Home"},null,-1),S=Object(s["g"])("div",{class:"nav-fill col-6"},[Object(s["g"])("h2",{class:"title"},"TITLE")],-1),q={class:"nav-right col-3"},U={class:"dropdown_container bell"},x=["data-value"],C={class:"dropdown_list"},F={class:"dropdown_container profile","aria-hidden":"true"},L=Object(s["g"])("input",{id:"user_profile_options",type:"checkbox",class:"dropdown_btn user"},null,-1),A={class:"dropdown_list"},I=Object(s["g"])("li",{class:"account_option"},[Object(s["g"])("a",null," Account ")],-1),R=Object(s["g"])("li",{class:"account_option"},[Object(s["g"])("a",null," Settings ")],-1),M={class:"account_option"},N=Object(s["i"])(" Log Out "),B=Object(s["g"])("label",{for:"user_profile_options"},null,-1);function T(e,t,n,a,r,c){var i=Object(s["B"])("router-link"),o=Object(s["B"])("FriendRequest"),u=Object(s["B"])("MessageNotification");return Object(s["t"])(),Object(s["f"])("header",null,[Object(s["g"])("div",y,[Object(s["g"])("div",$,[Object(s["j"])(i,{to:"/dashboard",class:"logo-main"},{default:Object(s["H"])((function(){return[k]})),_:1})]),S,Object(s["g"])("div",q,[Object(s["g"])("div",U,[Object(s["g"])("input",{type:"checkbox",class:"dropdown_btn fas fa-bell","data-value":c.getNotifications.length},null,8,x),Object(s["g"])("div",C,[Object(s["g"])("ul",null,[(Object(s["t"])(!0),Object(s["f"])(s["a"],null,Object(s["z"])(c.getNotifications,(function(e){return Object(s["t"])(),Object(s["f"])("li",{class:"row-flex",key:e.id},[11==e.content_type?(Object(s["t"])(),Object(s["d"])(o,{key:0,notification:e},null,8,["notification"])):Object(s["e"])("",!0),17==e.content_type?(Object(s["t"])(),Object(s["d"])(u,{key:1,notification:e},null,8,["notification"])):Object(s["e"])("",!0)])})),128))])])]),Object(s["g"])("div",F,[L,Object(s["g"])("div",A,[Object(s["g"])("ul",null,[I,R,Object(s["g"])("li",M,[Object(s["j"])(i,{to:"/account/logout",class:"logo-main"},{default:Object(s["H"])((function(){return[N]})),_:1})])])]),B])])])])}Object(s["u"])();var E={class:"friend_request"},P={key:0},D=["data-id"],H=["data-id"],V=Object(s["g"])("span",null,null,-1),z=Object(s["g"])("span",null," X ",-1);function J(e,t,n,a,r,c){return Object(s["t"])(),Object(s["f"])("div",E,[Object(s["g"])("p",null,Object(s["D"])(n.notification.message),1),98==c.currState?(Object(s["t"])(),Object(s["f"])("div",P,[Object(s["g"])("button",{"data-id":n.notification.id,type:"button",onClick:t[0]||(t[0]=function(e){return c.acceptFriendRequest(e)}),class:"friend_req_btn"},"Confirm",8,D),Object(s["g"])("button",{"data-id":n.notification.id,type:"button",class:"friend_req_btn"},"Ignore",8,H)])):Object(s["e"])("",!0),V,z])}n("ac1f"),n("5319");var G={name:"FriendRequest",props:["notification"],data:function(){return{state:null}},mounted:function(){this.$data.state=this.notification.friend_request.state},computed:{currState:function(){return this.$data.state}},methods:{acceptFriendRequest:function(e){var t=this;this.axios.patch("/api/notifications/"+e.target.getAttribute("data-id")+"/",{status:1,friend_request:"accepted"},{headers:{User:this.$store.getters["getCurrentUser"]}}).then((function(e){t.$data.state=1})).catch((function(e){e["redirect"]&&t.$router.replace(e["redirect"])}))}}};G.render=J;var W=G,K={class:"friend_request"},X=Object(s["g"])("span",null,null,-1),Y=Object(s["g"])("span",null," X ",-1);function Z(e,t,n,a,r,c){return Object(s["t"])(),Object(s["f"])("div",K,[Object(s["g"])("p",null,Object(s["D"])(n.notification.message),1),X,Y])}var Q={name:"MessageNotification",props:["notification"],data:function(){return{state:null}},mounted:function(){this.$data.state=1},computed:{currState:function(){return this.$data.state}},methods:{}};Q.render=Z;var ee=Q,te={name:"Header",components:{FriendRequest:W,MessageNotification:ee},data:function(){return{notifications:[]}},created:function(){var e=this;this.axios({method:"get",url:"/api/notifications",data:{},headers:{User:this.$store.getters["getCurrentUser"]}}).then((function(t){e.$store.dispatch("user/updateNotifications",t.data)}))},computed:{getNotifications:function(){return console.log(this.$store.getters["user/getNotifications"]),this.$store.getters["user/getNotifications"]}}};n("fea1");te.render=T,te.__scopeId="data-v-29222ba7";var ne=te,ae={name:"App",components:{Loaders:p,Alerts:w,Header:ne},mounted:function(){this.$sm_helpers.start()}};n("3a14");ae.render=o;var re=ae,ce=n("2909"),se=n("6c02"),ie=n("cf05"),oe=n.n(ie),ue={class:"home"},le=Object(s["g"])("img",{alt:"Vue logo",src:oe.a},null,-1),de=[le];function fe(e,t,n,a,r,c){return Object(s["t"])(),Object(s["f"])("div",ue,de)}var be={name:"Home"};be.render=fe;var pe=be,me={class:"account_container"},ge=Object(s["g"])("img",{alt:"Vue logo",src:oe.a},null,-1);function je(e,t,n,a,r,c){var i=Object(s["B"])("router-view");return Object(s["t"])(),Object(s["f"])("div",me,[ge,Object(s["j"])(i)])}n("caad");var he={name:"Account",created:function(){var e=this;this.unsubscribe=this.$store.subscribe((function(t,n){"setCurrentUser"===t.type&&["login","signUp"].includes(e.$router.currentRoute.value.name)&&n.username&&e.$router.replace("/dashboard")}))},beforeDestroy:function(){this.unsubscribe()}};n("67bd");he.render=je;var Oe=he,ve={class:"signup_bck"},_e=Object(s["g"])("h1",null,"Log In",-1),we={class:"sm-form"},ye={class:"input_container"},$e=Object(s["g"])("label",null,"Email: ",-1),ke={class:"input_container"},Se=Object(s["g"])("label",null,"Password: ",-1),qe={class:"submit_container"};function Ue(e,t,n,a,r,c){return Object(s["t"])(),Object(s["f"])("div",ve,[_e,Object(s["g"])("div",we,[Object(s["g"])("div",ye,[$e,Object(s["I"])(Object(s["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return r.user.email=e}),name:"user[email]"},null,512),[[s["F"],r.user.email]])]),Object(s["g"])("div",ke,[Se,Object(s["I"])(Object(s["g"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.user.password=e}),type:"password",name:"user[password]"},null,512),[[s["F"],r.user.password]])]),Object(s["g"])("div",qe,[Object(s["g"])("button",{onClick:t[2]||(t[2]=function(e){return c.firebase_login()}),id:"login_submit",class:"sm_submit_btn_1"}," Log In ")])])])}var xe={name:"Login",methods:{firebase_login:function(){var e=this,t=Object(c["b"])();this.$sm_helpers.show_loader(),Object(c["d"])(t,this.$data.user.email,this.$data.user.password).then(function(){var n=Object(a["a"])(regeneratorRuntime.mark((function n(a){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=a.user,n.next=3,r.getIdToken();case 3:s=n.sent,e.axios({method:"post",url:"/api/session/",headers:{Authorization:s}}).then((function(t){t.data&&t.data.username&&(e.$store.dispatch("setCurrentUser",t.data.username),e.$router.replace({name:"Dashboard"}))})).catch((function(n){e.$sm_helpers.show_alert("error","An error occurred while loging in."),Object(c["e"])(t)})).then((function(){e.$sm_helpers.hide_loader()}));case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(t){switch(e.$sm_helpers.hide_loader(),t.code){case"auth/wrong-password":case"auth/invalid-email":case"auth/user-not-found":e.$sm_helpers.show_alert("error","Password or email is incorrect.");break;default:e.$sm_helpers.show_alert("error","An error occurred while loging in.")}}))}},data:function(){return{user:{email:"",password:""}}}};xe.render=Ue;var Ce=xe,Fe={id:"main-app-container",class:"row-flex"};function Le(e,t,n,a,r,c){var i=Object(s["B"])("SideBar"),o=Object(s["B"])("MainStage");return Object(s["t"])(),Object(s["f"])("div",Fe,[Object(s["j"])(i),Object(s["j"])(o)])}Object(s["w"])("data-v-c0231440");var Ae={class:"main-stage-sm col-10"},Ie={class:"state",style:{color:"white"}};function Re(e,t,n,a,r,c){return Object(s["t"])(),Object(s["f"])("div",Ae,[Object(s["g"])("div",Ie,Object(s["D"])(e.$store.getters["main/getCurrentView"]),1)])}Object(s["u"])();var Me={name:"MainStage",props:{title:String}};n("7a31");Me.render=Re,Me.__scopeId="data-v-c0231440";var Ne=Me;Object(s["w"])("data-v-8c47f632");var Be={class:"side-bar-sm column-flex col-2"},Te=Object(s["g"])("div",{class:"side-container"},[Object(s["g"])("i",{class:"fas fa-home"})],-1),Ee={class:"side-container"},Pe=Object(s["g"])("i",{class:"fas fa-comments"},null,-1),De=Object(s["h"])('<div class="side-container" data-v-8c47f632><i class="far fa-play-circle" data-v-8c47f632></i></div><div class="side-container" data-v-8c47f632><i class="fas fa-search" data-v-8c47f632></i></div><div class="side-container" data-v-8c47f632><i class="far fa-list-alt" data-v-8c47f632></i></div>',3);function He(e,t,n,a,r,c){var i=Object(s["B"])("router-link");return Object(s["t"])(),Object(s["f"])("div",Be,[Te,Object(s["g"])("div",Ee,[Object(s["j"])(i,{to:"/chat/home"},{default:Object(s["H"])((function(){return[Pe]})),_:1})]),De])}Object(s["u"])();var Ve={name:"SideBar",props:{msg:String}};n("8d53");Ve.render=He,Ve.__scopeId="data-v-8c47f632";var ze=Ve,Je={name:"App",components:{MainStage:Ne,SideBar:ze}};n("3968");Je.render=Le;var Ge=Je,We={class:"signup_bck"},Ke=Object(s["g"])("h1",null,"Sign Up",-1),Xe={class:"sm-form"},Ye={class:"input_container"},Ze=Object(s["g"])("label",null,"Email: ",-1),Qe={class:"input_container"},et=Object(s["g"])("label",null,"Password: ",-1),tt={class:"submit_container"};function nt(e,t,n,a,r,c){return Object(s["t"])(),Object(s["f"])("div",We,[Ke,Object(s["g"])("div",Xe,[Object(s["g"])("div",Ye,[Ze,Object(s["I"])(Object(s["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return r.user.email=e}),name:"user[email]"},null,512),[[s["F"],r.user.email]])]),Object(s["g"])("div",Qe,[et,Object(s["I"])(Object(s["g"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.user.password=e}),type:"password",name:"user[password]"},null,512),[[s["F"],r.user.password]])]),Object(s["g"])("div",tt,[Object(s["g"])("button",{onClick:t[2]||(t[2]=function(e){return c.firebase_signup()}),id:"signup_submit",class:"sm_submit_btn_1"}," Sign Up ")])])])}var at={name:"Sign Up",methods:{firebase_signup:function(){var e=this;this.$sm_helpers.show_loader();var t=Object(c["b"])();Object(c["a"])(t,this.$data.user.email,this.$data.user.password).then(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(n){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=n.user,t.next=3,a.getIdToken();case 3:r=t.sent,e.axios({method:"post",url:"/api/users/",data:{username:a.uid,email:a.email},headers:{Authorization:r}}).then((function(t){t.data&&t.data.username&&(e.$store.dispatch("setCurrentUser",t.data.username),e.$router.replace({name:"Dashboard"}))}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$sm_helpers.hide_loader(),"auth/email-already-in-use"==t.code?e.$sm_helpers.show_alert("error","There was an error creating the account."):e.$sm_helpers.show_alert("error",t.message)}))}},data:function(){return{user:{email:"",password:""}}}};at.render=nt;var rt=at,ct={class:""},st=Object(s["g"])("h1",null,"You have logged out",-1),it=[st];function ot(e,t,n,a,r,c){return Object(s["t"])(),Object(s["f"])("div",ct,it)}var ut={name:"Logout",mounted:function(){var e=this,t=Object(c["b"])();Object(c["e"])(t).then((function(t){e.$store.dispatch("setCurrentUser",null)}))}};ut.render=ot;var lt=ut,dt=n("5502"),ft=function(){return{active_friends:[]}},bt={getActiveFriends:function(e){return e.active_friends}},pt={updateActiveFriends:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.commit,n.next=3,t.$sm.ajax({url:"/users/friend/",type:"GET",data:{online_only:!0},dataType:"JSON"});case 3:r=n.sent,a("updateActiveFriends",r);case 5:case"end":return n.stop()}}),n)})))()}},mt={updateActiveFriends:function(e,t){e.active_friends=JSON.parse(t)}},gt={namespaced:!0,state:ft,getters:bt,actions:pt,mutations:mt},jt=(n("1276"),function(){return{current_view:0}}),ht={getCurrentView:function(e){return e.current_view}},Ot={setCurrentView:function(e,t){var n=e.commit;n("setCurrentView",t)}},vt={setCurrentView:function(e,t){e.current_view=this.$sm.path_to_view_state(t.split("/"))}},_t={namespaced:!0,state:jt,getters:ht,actions:Ot,mutations:vt},wt=n("b85c"),yt=n("bc3a"),$t=n.n(yt),kt=function(){return{online_friends:[],friends:[],notifications:[]}},St={getOnlineFriends:function(e){return e.online_friends},getFriends:function(e){return e.friends},getNotifications:function(e){return e.notifications}},qt={updateOnlineFriends:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.commit,n.next=3,t.$sm.ajax({url:"/users/friend/",type:"GET",data:{online_only:!0},dataType:"JSON"});case 3:r=n.sent,a("updateOnlineFriends",r);case 5:case"end":return n.stop()}}),n)})))()},updateFriends:function(e,t){var n=e.commit,a="https://simul-music.herokuapp.com/";return $t.a.get(a+"/api/friends/",{headers:{User:this.getters["getCurrentUser"]},params:{page:t}}).then((function(e){n("updateFriends",e.data)})).catch((function(e){n("updateFriends",[])}))},updateNotifications:function(e,t){var n=e.commit;n("updateNotifications",t)}},Ut={updateOnlineFriends:function(e,t){e.online_friends=JSON.parse(t)},updateFriends:function(e,t){e.friends=[].concat(Object(ce["a"])(e.friends),Object(ce["a"])(t))},updateNotifications:function(e,t){if(t instanceof Array)e.notifications=t;else{var n,a=Object(wt["a"])(e.notifications);try{for(a.s();!(n=a.n()).done;){var r=n.value;r.id===r.id&&(r.message=t.content);break}}catch(c){a.e(c)}finally{a.f()}e.notifications=e.notifications}}},xt={namespaced:!0,state:kt,getters:St,actions:qt,mutations:Ut},Ct={username:null},Ft={getCurrentUser:function(e){return e.username}},Lt={setCurrentUser:function(e,t){var n=e.commit;n("setCurrentUser",t)}},At={setCurrentUser:function(e,t){e.username=t}},It=Object(dt["a"])({modules:{main:_t,chat:gt,user:xt},state:Ct,getters:Ft,actions:Lt,mutations:At});Object(s["w"])("data-v-7af6e8e4");var Rt={class:"chat_container row-flex"};function Mt(e,t,n,a,r,c){var i=Object(s["B"])("router-view"),o=Object(s["B"])("SearchUser"),u=Object(s["B"])("Modal1Container");return Object(s["t"])(),Object(s["f"])("div",Rt,[Object(s["j"])(i),Object(s["j"])(u,null,{default:Object(s["H"])((function(){return[Object(s["j"])(o)]})),_:1})])}Object(s["u"])(),Object(s["w"])("data-v-6ec551c6");var Nt={class:"modal_container"},Bt=Object(s["g"])("div",{class:"backdrop"},null,-1),Tt={class:"main_content"};function Et(e,t,n,a,r,c){return Object(s["t"])(),Object(s["f"])("div",Nt,[Bt,Object(s["g"])("div",Tt,[Object(s["A"])(e.$slots,"default",{},void 0,!0)])])}Object(s["u"])();var Pt={name:"Modal1Container"};n("99a9");Pt.render=Et,Pt.__scopeId="data-v-6ec551c6";var Dt=Pt;Object(s["w"])("data-v-18878d86");var Ht={class:"search_container column-flex"},Vt=Object(s["g"])("h3",null," Search Users ",-1),zt={class:"input_container"},Jt=Object(s["g"])("label",{for:"search_username"},"Username",-1),Gt={class:"btn_container"},Wt={id:"search_user_results",class:"result_container"},Kt=["data-id"],Xt=Object(s["g"])("i",{class:"fas fa-plus"},null,-1),Yt=[Xt],Zt={class:"confirmation hidden"},Qt=Object(s["g"])("span",null," Add Friend? ",-1);function en(e,t,n,a,r,c){return Object(s["t"])(),Object(s["f"])("div",Ht,[Vt,Object(s["g"])("div",zt,[Jt,Object(s["I"])(Object(s["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return r.search_query=e}),type:"text",id:"search_username"},null,512),[[s["F"],r.search_query]])]),Object(s["g"])("div",Gt,[Object(s["g"])("button",{onClick:t[1]||(t[1]=function(){return c.searchUser&&c.searchUser.apply(c,arguments)})},"SEARCH")]),Object(s["g"])("div",Wt,[Object(s["g"])("ul",null,[(Object(s["t"])(!0),Object(s["f"])(s["a"],null,Object(s["z"])(r.users,(function(e){return Object(s["t"])(),Object(s["f"])("li",{key:e.username,"data-id":e.user_id},[Object(s["i"])(Object(s["D"])(e.username)+" ",1),Object(s["g"])("button",{onClick:t[2]||(t[2]=function(e){return c.confirmFriendRequest(e)})},Yt),Object(s["g"])("div",Zt,[Object(s["g"])("section",null,[Qt,Object(s["g"])("button",{onClick:t[3]||(t[3]=function(e){return c.sendFriendRequest(e)})},"Yes"),Object(s["g"])("button",{onClick:t[4]||(t[4]=function(e){return c.cancelFriendRequest(e)})},"No")])])],8,Kt)})),128))])])])}Object(s["u"])();var tn={name:"SearchUser",data:function(){return{search_query:"",users:[]}},methods:{searchUser:function(){var e=this;this.$data.search_query&&(console.log(this.$store.getters["getCurrentUser"]),this.axios.get("/api/user_profile/",{headers:{User:this.$store.getters["getCurrentUser"]},params:{username:this.$data.search_query}}).then((function(t){void 0!=t.data&&(e.$data["users"]=t.data)})).catch((function(t){Object(c["b"])();t["redirect"]&&e.$router.replace(t["redirect"])})))},confirmFriendRequest:function(e){var t,n=e.target.closest("li"),a=Object(wt["a"])(document.querySelectorAll(".confirmation"));try{for(a.s();!(t=a.n()).done;){var r=t.value;r.classList.add("hidden")}}catch(c){a.e(c)}finally{a.f()}n.querySelector(".confirmation").classList.remove("hidden")},cancelFriendRequest:function(e){var t=e.target.closest("li");t.querySelector(".confirmation").classList.add("hidden")},sendFriendRequest:function(e){var t=this,n=e.target.closest("li").getAttribute("data-id");this.axios.post("/api/users/".concat(n,"/friend_request/"),{},{headers:{User:this.$store.getters["getCurrentUser"]}}).then((function(n){n&&n.data["success"]&&(t.$sm_helpers.show_alert("error",n.data["success"]),e.target.closest(".confirmation").classList.add("hidden"))})).catch((function(e){400==e["status"]&&t.$sm_helpers.show_alert("error","Friend Request already sent")}))}}};n("288f");tn.render=en,tn.__scopeId="data-v-18878d86";var nn=tn,an={name:"Chat",components:{Modal1Container:Dt,SearchUser:nn}};n("9ad5");an.render=Mt,an.__scopeId="data-v-7af6e8e4";var rn=an;Object(s["w"])("data-v-84bd8a2e");var cn={class:"_root"},sn=Object(s["g"])("h1",null,"INDEX CHAT",-1),on={class:"chat_sidebar column-flex"},un={class:"chat_main column-flex"};function ln(e,t,n,a,r,c){var i=Object(s["B"])("FriendList"),o=Object(s["B"])("UserMessagePreview");return Object(s["t"])(),Object(s["f"])("div",cn,[sn,Object(s["g"])("div",on,[Object(s["j"])(i)]),Object(s["g"])("div",un,[Object(s["g"])("ul",null,[Object(s["g"])("li",null,[Object(s["j"])(o)])])])])}Object(s["u"])();n("fb6a");Object(s["w"])("data-v-b69b9cf8");var dn={class:"friend_list"},fn=["data-fid"],bn=Object(s["g"])("div",{class:"search_container column-flex"},[Object(s["g"])("button",null,"Add Friend +")],-1);function pn(e,t,n,a,r,c){var i=Object(s["B"])("router-link");return Object(s["t"])(),Object(s["f"])("div",dn,[Object(s["g"])("ul",null,[(Object(s["t"])(!0),Object(s["f"])(s["a"],null,Object(s["z"])(this.$store.getters["user/getFriends"].slice(0,10*r.page),(function(e){return Object(s["t"])(),Object(s["f"])("li",{key:e.username},[Object(s["j"])(i,{to:{name:"Message",params:{id:"new"},query:{fid:e.id}},class:"logo-main"},{default:Object(s["H"])((function(){return[Object(s["g"])("h5",null,Object(s["D"])(e.username),1)]})),_:2},1032,["to"]),Object(s["g"])("i",{onClick:t[0]||(t[0]=function(e){return c.requestMessageRoom(e)}),"data-fid":e.id,class:"fas fa-comment-medical"},null,8,fn)])})),128))]),bn])}Object(s["u"])();var mn={name:"FriendList",data:function(){return{page:0}},created:function(){var e=this;0==this.$store.getters["user/getFriends"].length?this.$store.dispatch("user/updateFriends",this.$data.page).then((function(t){e.$data.page+=1,console.log(e.$store.getters["user/getFriends"].slice(0,10*e.$data.page))})):e.$data.page+=1},methods:{requestMessageRoom:function(e){var t=this,n=e.target.dataset.fid;n&&this.axios.get("api/friends/"+n+"/chat",{headers:{User:this.$store.getters["getCurrentUser"]}}).then((function(e){e.data.room_uid&&t.$router.push({name:"Message",params:{id:e.data.room_uid}})}))}}};n("30c5");mn.render=pn,mn.__scopeId="data-v-b69b9cf8";var gn=mn;Object(s["w"])("data-v-48b96cab");var jn={class:"user-message-preview row-flex"},hn=Object(s["h"])('<a class="profile" data-v-48b96cab><img src="https://icons.iconarchive.com/icons/paomedia/small-n-flat/1024/cat-icon.png" data-v-48b96cab></a><a class="message" data-v-48b96cab><h3 data-v-48b96cab>NAME</h3><p class="message" data-v-48b96cab> Lorem ipsum, dolor sit amet consectetur adipisicing elit. Voluptas, modi aperiam, aliquam possimus doloribus ipsum quisquam itaque iusto nulla sint fugit saepe animi tempora eos fugiat! Expedita architecto dicta nobis? </p></a><div class="options" data-v-48b96cab></div>',3),On=[hn];function vn(e,t,n,a,r,c){return Object(s["t"])(),Object(s["f"])("div",jn,On)}Object(s["u"])();var _n={name:"UserMessagePreview"};n("a51c");_n.render=vn,_n.__scopeId="data-v-48b96cab";var wn=_n,yn={name:"Index",components:{FriendList:gn,UserMessagePreview:wn}};n("0efc");yn.render=ln,yn.__scopeId="data-v-84bd8a2e";var $n=yn;Object(s["w"])("data-v-7f937407");var kn={class:"message_root"},Sn={key:0},qn={class:"message_container"},Un={class:"messages"},xn={class:"sent_at"},Cn={class:"new_message_container"},Fn=Object(s["g"])("button",{class:"options",type:"button"},[Object(s["g"])("i",{class:"fas fa-ellipsis-v"})],-1),Ln=Object(s["g"])("i",{class:"fas fa-arrow-circle-right"},null,-1),An=[Ln];function In(e,t,n,a,r,c){return Object(s["t"])(),Object(s["f"])("div",kn,[null!=this.other_participant?(Object(s["t"])(),Object(s["f"])("h1",Sn,Object(s["D"])(this.other_participant.username),1)):Object(s["e"])("",!0),Object(s["g"])("div",qn,[Object(s["g"])("ul",Un,[(Object(s["t"])(!0),Object(s["f"])(s["a"],null,Object(s["z"])(this.messages,(function(e){return Object(s["t"])(),Object(s["f"])("li",{class:Object(s["p"])("message "+(e.owner?"sent":"received")),key:e.id},[Object(s["i"])(Object(s["D"])(e.content)+" || "+Object(s["D"])(e.updated_at)+" ",1),Object(s["g"])("span",xn,Object(s["D"])(e.sent_at),1)],2)})),128))])]),Object(s["g"])("div",Cn,[Fn,Object(s["g"])("textarea",{class:"message_input",id:"new_message",cols:"30",onKeydown:t[0]||(t[0]=Object(s["J"])(Object(s["K"])((function(e){return c.sendMessage()}),["exact","prevent"]),["enter"]))},null,32),Object(s["g"])("button",{class:"send",type:"button",onClick:t[1]||(t[1]=function(e){return c.sendMessage()})},An)])])}Object(s["u"])();n("7db0"),n("2532");var Rn={name:"MessageView",data:function(){return{other_participant:null,messages:[],socket:null}},created:function(){var e=this;this.axios.get("api/message_room/"+this.$route.params.id,{headers:{User:this.$store.getters["getCurrentUser"]}}).then((function(t){e.messages=t.data.message_set,setTimeout((function(){var e=document.querySelector(".message_container");e.scrollTop=e.scrollHeight}),300);var n=e.$sm.map_without_duplicates(t.data.message_set,"user_id",{cond_check:"owner",check_return:null});if(e.$store.getters["user/getFriends"].length){var a=e.$store.getters["user/getFriends"].find((function(e){return n.includes(e.id)}));a&&(e.other_participant=a)}else e.$store.dispatch("user/updateFriends").then((function(){var t=e.$store.getters["user/getFriends"].find((function(e){return n.includes(e.id)}));t&&(e.other_participant=t)}));return t.data.id})).then((function(t){var n=new WebSocket("ws:////127.0.0.1:8000/ws/sm/chat/".concat(t,"/?Authentication=").concat(e.$store.getters["getCurrentUser"]));n.onopen=function(){e.socket=n},n.onclose=function(t){e.socket=null,t.wasClean?console.log("[close] Connection closed cleanly, code=".concat(t.code," reason=").concat(t.reason)):console.log("[close] Connection died")},n.onmessage=function(t){var n=JSON.parse(t.data);e.messages.push(n),setTimeout((function(){var e=document.querySelector(".message_container");e.scrollTop=e.scrollHeight}),300)}}))},methods:{sendMessage:function(){this.socket&&(this.socket.send(JSON.stringify({type:"send",msg:document.getElementById("new_message").value})),document.getElementById("new_message").value="")}},beforeRouteLeave:function(e,t,n){this.socket&&this.socket.close(1e3),n()}};n("6db8");Rn.render=In,Rn.__scopeId="data-v-7f937407";var Mn=Rn,Nn=[{path:"/chat/",name:"Chat",component:rn,children:[{path:"index",component:$n,alias:"home",name:"Chat Index"},{path:"message/:id",component:Mn,name:"Message"}],meta:{authRequired:!0}}],Bn=[{path:"/",name:"Home",component:pe},{path:"/account/",component:Oe,children:[{path:"login",name:"login",component:Ce},{path:"signup",name:"signup",component:rt},{path:"logout",name:"logout",component:lt}]},{path:"/dashboard",name:"Dashboard",component:Ge,meta:{authRequired:!0}}].concat(Object(ce["a"])(Nn)),Tn=Object(se["a"])({history:Object(se["b"])("/"),routes:Bn}),En=Tn,Pn=(n("498a"),n("25f0"),n("6062"),n("3ca3"),n("ddb0"),n("4de4"),n("d81d"),{find_cookie:function(e){var t=document.cookie.split(";").find((function(t){return t.split("=")[0].trim()==e.toString()}));return t},map_without_duplicates:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{cond_check:null,check_return:void 0};return"[object Array]"!==Object.prototype.toString.call(e)||0==e.length?[]:Object(ce["a"])(new Set(e.map((function(e){return n["cond_check"]&&void 0!==n["check_return"]&&e[n["cond_check"]]?n["check_return"]:e[t]})).filter((function(e){return null!==e&&void 0!==e}))))}}),Dn={show_loader:function(){document.querySelector(".loader-wrapper").classList.add("active"),document.querySelector(".loader-wrapper #circle-wave-loader").classList.add("active")},hide_loader:function(){document.querySelector(".loader-wrapper").classList.remove("active"),document.querySelector(".loader-wrapper #circle-wave-loader").classList.remove("active")},show_alert:function(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=document.querySelector("#sm-alert-container");(n=r.classList).remove.apply(n,Object(ce["a"])(r.classList)),r.querySelector(".message > span").innerHTML=t,r.classList.add(e,"loading"),a>0&&setTimeout((function(){var e;(e=r.classList).remove.apply(e,Object(ce["a"])(r.classList))}),a)},hide_alert:function(){var e=document.querySelector("#sm-alert-container");e.classList.add("close")},start:function(){document.querySelector("#sm-alert-container > .close").addEventListener("click",(function(){var e=document.querySelector("#sm-alert-container");e.classList.add("close"),e.classList.remove("error","info","warning","success","loading")}))}},Hn=$t.a.create({baseURL:"https://simul-music.herokuapp.com/"});Hn.interceptors.response.use((function(e){return e}),(function(e){var t={};return 403==e.request.status?(Object(c["e"])(Object(c["b"])()),t["redirect"]="/account/login"):(t["status"]=e.request.status,t["logout"]=!1),Promise.reject(t)}));var Vn=null;Vn={apiKey:"AIzaSyAztGZeWuhkTq6NYZyDAWl4rEEEyIUqzrc",authDomain:"simul-music.firebaseapp.com",projectId:"simul-music",storageBucket:"simul-music.appspot.com",messagingSenderId:"388855346937",appId:"1:388855346937:web:700c07539fb0875cc61428"},Object(r["a"])(Vn);var zn=Object(c["b"])();Object(c["c"])(zn,function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,t.getIdToken();case 3:n=e.sent,Hn({method:"post",url:"/api/session/",headers:{Authorization:n}}).then((function(e){e.data&&e.data.username&&It.dispatch("setCurrentUser",e.data.username)})).then((function(e){var t="https://simul-music.herokuapp.com",n=new WebSocket("ws:////".concat(t,"/ws/sm/events/?Authentication=").concat(It.getters["getCurrentUser"]));n.onmessage=function(e){try{var t=JSON.parse(e.data);"notification"==t.type&&It.dispatch("user/updateNotifications",t.notification)}catch(n){console.log("MESSAGE NOT PARSABLE")}}}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),En.beforeEach((function(e,t,n){document.querySelector("#sm-alert-container").classList.add("hidden"),document.querySelector(".loader-wrapper #circle-wave-loader").classList.remove("active"),e.meta.authRequired&&!It.getters["getCurrentUser"]?(Dn.show_loader(),setTimeout((function(){Dn.hide_loader(),It.getters["getCurrentUser"]?(document.title=e.name,n()):(document.title="LOGIN",n({path:"/account/login"}))}),2e3)):(document.title=e.name,n())}));var Jn=Object(s["c"])(re);Jn.config.globalProperties.$sm=Pn,Jn.config.globalProperties.$sm_helpers=Dn,Jn.config.globalProperties.axios=Hn,Jn.use(It),Jn.use(En),Jn.mount("#__site-wrapper")},"67bd":function(e,t,n){"use strict";n("d1a0")},"6db8":function(e,t,n){"use strict";n("c91c")},"79d8":function(e,t,n){},"7a31":function(e,t,n){"use strict";n("8021")},8021:function(e,t,n){},"8d53":function(e,t,n){"use strict";n("5044")},"8e5d":function(e,t,n){},"94a9":function(e,t,n){},"99a9":function(e,t,n){"use strict";n("f327")},"9ad5":function(e,t,n){"use strict";n("1683")},a3da:function(e,t,n){},a51c:function(e,t,n){"use strict";n("a3da")},b511:function(e,t,n){},c91c:function(e,t,n){},cf05:function(e,t,n){e.exports=n.p+"img/logo.82b9c7a5.png"},d1a0:function(e,t,n){},f327:function(e,t,n){},fea1:function(e,t,n){"use strict";n("3192")}});
//# sourceMappingURL=app.5e53155a.js.map